<script>
    export let repos = [];

    // initially all panels are closed
    let panel_activity = [false, false, false, false, false, false];
    let active_panel_index = null;

    // handler for either click and enter key event
    const toggle_panel = (event) => {
        // only allow enter and click events to toggle panel
        if(event.key === 'Enter' || event.type === 'click'){
            // get the closest .accordion-item when a panel is clicked 
            const active_panel = event.target.closest('.accordion-item');
            // console.log(active_panel);

            // identify index of this active panel
            active_panel_index = Array.from(active_panel.parentNode.children).indexOf(active_panel);

            // set this panels activity to true based on its index
            // set all other panels activity to false
            panel_activity = panel_activity.map((_, index) => {
                return active_panel_index === index ? true : false;
            });
        }

        return;
    };
</script>

<div class="accordion-group">
    {#each repos as repo, index}
        <div style:--project-animation-order={index + 1} class="accordion-item" aria-expanded={panel_activity[index]} tabindex={0} on:click={toggle_panel} on:keypress={toggle_panel}>
            <h1 class="project-id" data-project-id={repo['project_id']}></h1>
            <div class="project-content" id="project-content">
                <h4 class="project-title">{repo['name']}</h4>
                <p class="project-description">{repo['description']}</p>
                <a href={repo['html_url']} class="project-link">
                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="1344" height="1344" viewBox="0 0 1008 1008">
                        <path d="M705.5 3.2c-8 3.9-14.7 10.7-18.2 18.2-2.4 5.2-2.8 7.4-2.8 14.6 0 7.6.4 9.3 3.2 15.1 3.9 7.9 10.2 14 18.1 17.7l5.7 2.7 86.3.3c47.4.1 86.2.6 86.2 1.1 0 .4-91.7 92.5-203.7 204.5C388.5 569.3 325.6 632.7 322.9 638c-1.9 3.6-2.4 6.1-2.4 12.5 0 7 .4 8.7 2.9 13.2 3.5 6.3 15.4 18.1 21.6 21.4 6.4 3.4 18.5 3.4 25 0 5.3-2.7 67.6-64.3 361.1-357.2 112.3-112 204.3-203.1 204.5-202.5.2.6.5 39.4.6 86.1l.3 85 3.2 6.6c3.9 7.9 10.2 14 18.1 17.7 4.8 2.3 7.1 2.7 14.2 2.7s9.4-.4 14.2-2.7c7.9-3.7 14.1-9.7 18.2-18l3.6-7V161.9c0-76.3-.4-134.7-.9-135.7-.5-.9-1.9-3.8-3.2-6.5-2.7-5.6-10.9-13.7-16.4-16.1-2.2-1-4.8-2.2-5.7-2.7-1.1-.5-56.5-.9-136-.8L711.5.2l-6 3z"/><path d="M107 138.5c-.8.2-4.9.9-9 1.5-23.2 3.8-46 15.8-63.6 33.4-17.1 17.2-28 37.3-32.9 60.6C.2 240.3 0 281.4 0 573c0 361.8-.4 336 5.5 353.6 9.8 29.2 32.1 54.6 60.3 68.8 8.5 4.3 21.6 8.7 31.7 10.7 10.5 2.1 631.5 2.1 642 0 24.5-4.8 45.8-16.2 63.1-33.5 13.9-14 23.5-29.6 29.3-47.4 5.9-18.1 5.6-9.1 5.6-182.4 0-87.8.3-159.4.8-159.1.4.2.7-4.3.7-10.1 0-6.5-.4-10.6-1-10.6s-.8-1.1-.4-2.6c.5-1.8.3-2.5-.3-2.1-.6.4-1.4 0-1.7-.9-.9-2.4-.7-3.1.4-1.4.7 1 1 1.1 1 .2 0-.7-.7-1.5-1.5-1.8-.9-.4-1.4-1.1-1.3-1.8.2-.6-.6-2.1-1.7-3.2-1.1-1.2-3.3-3.8-4.9-5.9-1.6-2-4.8-4.9-7.2-6.5-2.4-1.5-4-3-3.7-3.4.4-.4 0-.4-1 0-.9.3-1.7.2-1.7-.3 0-1-1.1-1.1-11.1-1.3-6.1-.2-8 .3-13.4 2.9-7.5 3.7-13.3 9.8-17.4 18.3-1.5 3.2-3.1 5.5-3.6 5.1-.4-.5-.5.4-.1 1.9.3 1.6.3 2.8-.1 2.8-.5 0-.7 73.9-.5 164.2.3 121.3 0 165.9-.8 170.3-3.7 19.1-19.7 35.4-38.8 39.4-7.5 1.6-611.9 1.6-619.4 0-18.7-3.9-34.8-20-38.7-38.7-1.6-7.5-1.6-642.9 0-650.4 4-19.1 20.4-35.2 39.4-38.7 6.9-1.3 299.6-2.1 298.8-.9-.2.5 4.4.8 10.2.8 7.7 0 10.4-.3 9.9-1.1-.5-.9.1-1 2-.5 3 .7 6.9-.1 6.2-1.3-.3-.3 2-1.9 4.9-3.5 4.6-2.4 8.9-6.4 15.9-14.8.8-.9 1.2-1.9.8-2.2-.3-.4.3-1.2 1.3-2 3.6-2.6 3-23.2-.6-21-.7.4-.9 0-.5-1.4.4-1.2.2-2.3-.5-2.8-.8-.4-.9-.3-.5.4s.5 1.2.2 1.2-1-1-1.7-2.1c-.9-1.7-.8-2 .3-1.3.7.4-1.1-1.5-4-4.2-5.8-5.3-15.6-11.4-18.5-11.4-1 0-1.6-.4-1.3-.9.3-.5 0-1.1-.8-1.4-1.5-.6-321.9-.7-324.6-.2zm323.7 1.1c-.3.3-1.2.4-1.9.1-.8-.3-.5-.6.6-.6 1.1-.1 1.7.2 1.3.5zm30 31.6c-.3.7-.5.2-.5-1.2s.2-1.9.5-1.3c.2.7.2 1.9 0 2.5zm0 7c-.3.7-.5.2-.5-1.2s.2-1.9.5-1.3c.2.7.2 1.9 0 2.5z"/>
                    </svg>
                </a>
                <div 
                    class="project-stats" 
                    data-star-count={repo['stargazers_count'] === undefined ? '\0' : repo['stargazers_count']}
                    data-fork-count={repo['forks_count']  === undefined ? '\0' : repo['forks_count']}>
                    <svg class="github-fork" version="1.0" xmlns="http://www.w3.org/2000/svg" width="1344" height="1344" viewBox="0 0 1008 1008">
                        <path d="M221.5 1.6c-20.1 3.3-42 12.5-58.9 24.5-51.3 36.5-72.3 103.1-51.4 162.8 4.2 12.1 12.8 28.3 20.3 38.3 7.7 10.3 22.4 24.5 32.7 31.6 9.3 6.4 24.8 14.2 34.5 17.3l7.3 2.4v61c0 33.5.5 67.1 1 74.5 5.9 76.7 59.2 137.6 131.5 150 10.8 1.8 16.2 2 69.1 2H465v81.5c0 76.8-.1 81.6-1.7 82.2-26.4 9.1-44.5 20.2-61.9 38-17.9 18.4-31.2 43.5-37 70.3-2.7 12.1-2.7 43.9 0 56 12.1 55.7 51.8 96.7 107.1 110.7 10.3 2.6 12.3 2.8 32.5 2.8s22.2-.2 32.5-2.8c55.5-14 94.9-54.8 107.1-110.7 2.7-12.1 2.7-43.9 0-56-5.8-26.8-19.1-51.9-37-70.3-17.4-17.8-35.5-28.9-61.8-38-1.7-.6-1.8-5.4-1.8-82.1v-81.5l60.3-.4c57.8-.3 60.6-.4 70-2.5 32.6-7.4 57.8-21.2 80.8-44.1 28.1-28.2 43.4-61 46.8-100.6.6-6.7 1.1-40.1 1.1-76v-64l7.1-2.3c19.3-6.1 37.4-17.6 54-34.1 25.8-25.9 39.7-57.2 41.6-93.6 2.9-57-28.3-109.2-80.2-134.6C804.3 4 786.3 0 762.4 0c-17.1 0-29 1.9-44.5 7-20.5 6.8-37.4 16.9-53 31.7-45 42.8-57.1 108.8-30.3 164.8 16 33.5 44.7 59.4 79.9 72.1l9 3.2v140.7l-2.8 8.8c-4.9 15.8-11.7 26.7-23.5 37.9a81.6 81.6 0 01-46.2 21.7c-11.4 1.5-284.4 1.5-295.6.1-31-3.9-55.8-25.1-66.3-56.5-5-15-5.2-19.6-4.9-88.9l.3-63.8 9-3.2c68.9-24.8 107.6-97.8 89.6-169-10-39.4-37.8-73.8-74.4-92.3-9.6-4.8-28.4-10.8-39.6-12.7-11.6-2-36.2-2-47.6 0zm36.3 76.9c19 3.8 36.6 17.3 45.1 34.5 9.4 19.2 9.3 38.6-.2 58-7.7 15.9-24.7 29.4-41.8 33.5-3.5.8-10.7 1.5-15.9 1.5-18.4 0-32.1-5.8-45.5-19.4-9.1-9.2-14.3-18.4-17.1-30.1-2.4-10.2-1.5-26.7 1.8-35.7 11.6-31.1 42-48.6 73.6-42.3zm524.9 2c19.4 6.5 33.7 20.6 41.1 40.3 3.3 9 4.2 25.5 1.8 35.7-2.9 12-7.9 20.9-17.6 30.6-13.3 13.4-26.5 18.9-45 18.9-18.6 0-33-6-46-19-19.8-19.7-24.4-48.5-11.9-74 8.3-16.9 25.8-30.4 44.4-34.5 9.9-2.1 23.3-1.3 33.2 2zm-263.2 723c31.9 8.3 52.8 38.8 48.5 70.8-3.6 25.8-20.9 46.1-46 53.8-11 3.4-26.4 3.2-37.6-.5-18.6-6-34-20.7-40.8-38.7-13.4-35.8 7.2-75.4 44.4-85.3 7.4-2 24-2 31.5-.1z"/>
                    </svg>
                    <svg class="github-star" version="1.0" xmlns="http://www.w3.org/2000/svg" width="1344" height="1344" viewBox="0 0 1008 1008">
                        <path d="M495.5 27.4c-12.5 4-17.7 9.4-27 28.3-11.9 24.1-51 103.4-70.7 143.3-10.5 21.2-28.7 57.9-40.4 81.7-17.6 35.7-21.7 43.3-23.6 43.8-1.3.2-13.3 2-26.8 4-13.5 1.9-27.6 3.9-31.5 4.5-3.8.6-9.7 1.5-13 2-3.3.5-9.6 1.4-14 2-4.4.6-10.7 1.5-14 2-3.3.5-9.6 1.4-14 2-4.4.6-10.7 1.5-14 2.1-3.3.5-17 2.5-30.5 4.4-13.5 2-29.2 4.3-35 5.1-5.8.9-13.2 2-16.5 2.4-3.3.5-9.6 1.4-14 2-4.4.6-10.7 1.5-14 2-9.1 1.3-31.6 4.6-54.3 7.9-22.9 3.4-27.4 5.1-34.2 12.8-6.1 7-7.4 10.6-7.8 21.6-.6 16-.4 16.3 36.5 52.1 28.7 27.8 46.3 45 142.8 139.2 20.4 19.8 40.5 39.4 44.8 43.5 7.5 7 7.9 7.5 7.3 10.9-.3 1.9-1.7 10-3.1 18-5.2 29.9-8.7 49.7-9.5 55-.5 3-2.9 17.4-5.4 32-10.2 58.5-12.8 73.7-13.6 79-.8 5.2-4.2 25-12.5 72.5-2 11.6-4 23.5-4.5 26.5s-1.6 9.7-2.5 14.9c-1 5.2-1.5 11.8-1.3 14.5.9 11.3 8.9 22.4 19.7 27.5 4.7 2.2 7 2.6 14.2 2.6 9.4 0 11-.6 37.9-15 5.2-2.8 17.2-9.1 26.5-14 9.4-4.8 17.5-9.1 18-9.5.6-.4 9.1-4.9 19-10s20.3-10.5 23-12c6.1-3.3 19.9-10.6 36-19 6.6-3.5 15.2-8 19-10 3.9-2 13.3-7 21-11 7.7-4 15.4-8 17-9 1.7-1 10.4-5.6 19.5-10.3 9.1-4.7 21.5-11.2 27.5-14.4 6.1-3.2 14.5-7.6 18.8-9.8l7.7-4 9.8 5c5.3 2.7 13.5 7 18.2 9.6 4.7 2.5 16.2 8.5 25.5 13.4 9.4 4.8 19.3 10 22 11.5 2.8 1.5 10.4 5.5 17 9 6.6 3.4 15.2 7.9 19 10 3.9 2 12.4 6.5 19 10 15.2 7.9 28.8 15.1 39 20.5 4.4 2.3 13.9 7.3 21 11 7.2 3.7 15.3 8 18 9.5 2.8 1.5 11.8 6.2 20 10.5 8.3 4.3 20.4 10.7 27 14.2 25.7 13.7 25.9 13.8 35.4 13.8 7.2 0 9.5-.4 14.2-2.6 10.8-5.1 18.8-16.2 19.7-27.5.2-2.7-.3-9.3-1.3-14.5-.9-5.2-2-11.9-2.5-14.9s-2.5-14.9-4.5-26.5c-8.3-47.5-11.7-67.3-12.5-72.5-.8-5.3-3.4-20.5-13.6-79-2.5-14.6-4.9-29-5.4-32s-1.8-10.7-2.9-17c-2.7-15.4-9.1-52.8-9.8-56.5-.4-2.7.3-3.7 6.9-9.9 7.6-7.3 27.9-27 63.3-61.6 11.6-11.3 28.9-28.2 38.5-37.5 36.2-35.3 96.9-94.4 106.8-104 13.6-13.2 16.2-18.1 16.2-30.9 0-7.4-.4-10-2.4-14.2-4.3-9.2-11.9-15.8-21.1-18.3-3.4-.9-31.6-5.3-59-9.1-3.3-.5-9.4-1.3-13.5-1.9-4.1-.6-13.6-2-21-3.1s-16.7-2.4-20.6-3c-3.9-.5-13.3-1.8-21-3-15-2.2-86-12.6-95.9-14-3.3-.5-9.4-1.3-13.5-1.9-4.1-.6-18.1-2.6-31-4.5-12.9-1.9-25.5-3.8-28-4.1-2.5-.3-5.5-.8-6.8-1.1-2-.4-5.5-7-21.6-39.7-10.7-21.6-28-56.8-38.6-78.2-10.6-21.5-29-58.8-41-83-43.5-88.3-40.8-83.1-46.5-88.4-8.5-7.7-21.1-10.9-31-7.7zM515 158.7c5.7 11.5 18.1 36.5 27.5 55.8 9.5 19.2 29.3 59.3 44 89 14.6 29.7 28.5 57.8 30.8 62.4 2.4 4.9 6 10.2 8.7 12.9 7.9 8 10.4 8.7 49.5 14.2 3.3.5 9.6 1.4 14 2 4.4.6 10.7 1.5 14 2 3.3.4 17 2.4 30.5 4.4 38.9 5.8 68.4 10.1 85.5 12.4 3.9.6 21.4 3.1 39 5.7s34.2 5 36.9 5.4c2.7.3 5.1 1.1 5.3 1.6.2.6-5.2 6.5-11.9 13-6.8 6.6-21.1 20.5-31.8 30.9-10.7 10.5-29 28.2-40.5 39.5-11.6 11.4-29.1 28.5-39 38.1-50.9 49.4-65.7 64.5-68.1 69.2-3.6 7.2-4 14.9-1.4 29.8 1.1 6.9 2.5 15 3 18 1.1 6.9 6.2 36.7 8.9 52 3 17 9.1 52.7 10.1 59 .5 3 1.8 10.7 2.9 17 2 11.6 5 28.8 11.6 67.5 5 29.3 5.5 32 5.5 32.2 0 1-3.7-.1-8.2-2.6-9.4-5-23.9-12.6-39.3-20.6-8.2-4.3-15.4-8.1-16-8.5-.5-.4-9.5-5.1-20-10.5-10.4-5.4-19.4-10.1-20-10.5-.5-.4-8.2-4.4-17-9-8.8-4.5-18.2-9.5-21-11-2.7-1.5-10.8-5.8-18-9.5-7.1-3.7-16.7-8.7-21.2-11.1-46.9-24.9-53.7-28.2-59.5-29.4-8.3-1.6-15 0-28.3 7-6 3.1-17.3 9-25 13-7.7 4-15.3 8-17 9-1.6 1-11.1 5.9-21 11s-18.4 9.6-19 10c-.5.4-9.1 4.9-19 10s-18.4 9.6-19 10c-.5.4-9.1 4.9-19 10s-19.3 10-21 11c-1.6 1-9.7 5.2-18 9.5-8.2 4.3-17.7 9.2-21 11-19.1 10.4-24.5 12.8-24.5 11.2 0-.3 3.3-19.9 6.4-37.7 11.8-68.2 14.5-84.2 15.6-91 1-6.2 6.3-37.2 8.6-50 1.9-10.5 7.2-41.6 8.4-49 .5-3 1.9-11.1 3-18 2.6-14.9 2.2-22.6-1.4-29.8-2.5-4.9-17.2-19.9-70.1-71.2-9.9-9.6-27.4-26.7-39-38.1-11.5-11.3-29.3-28.6-39.5-38.5-39.4-38.2-43-41.9-42.7-42.9.2-.5 2.6-1.3 5.3-1.6 2.7-.4 19.3-2.8 36.9-5.4 17.6-2.6 34.7-5.1 38-5.5 9-1.3 21.3-3 28-4 3.3-.5 9.4-1.3 13.5-1.9 4.1-.6 13.4-1.9 20.5-3 14.8-2.3 46-6.9 55-8.1 3.3-.5 9.6-1.4 14-2 4.4-.6 10.7-1.5 14-2 3.3-.4 11.2-1.6 17.5-2.5 13.7-1.9 19.3-3.2 24.1-5.6 6.3-3.1 12.2-10 17.1-20 7.2-14.5 49.8-100.8 77.8-157.4 13.8-28.1 27.2-55.2 29.7-60.3 2.4-5 4.8-9.2 5.2-9.2.5 0 5.5 9.3 11.1 20.7z"/>
                    </svg>
                </div>
            </div>
            <img class="project-image" src={repo['project_image']} alt={repo['name']}>
        </div>    
    {/each}
</div>